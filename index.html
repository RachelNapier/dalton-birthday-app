<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dalton // 24 ‚Äî Night City Uplink ‚Ä¢ built by Rachel</title>
    <meta name="theme-color" content="#0ea5a3" />
    <meta name="description" content="A sweet interactive birthday page for Dalton." />
    <!-- Social preview -->
    <meta property="og:title" content="Dalton‚Äôs Birthday App ‚Äî built by Rachel">
    <meta property="og:description" content="Open it, play a song, leave notes, and smile„ÉÑ">
    <meta property="og:image" content="icon-512.png">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dalton‚Äôs Birthday App ‚Äî built by Rachel">
    <meta name="twitter:description" content="Open it, play a song, leave notes, and smile„ÉÑ">
    <meta name="twitter:image" content="icon-512.png">
    <!-- Favicon: birthday cake emoji -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E%F0%9F%8E%82%3C/text%3E%3C/svg%3E" />
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React + ReactDOM UMD -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for in-browser JSX transform -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="icon-180.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  </head>
  <body class="min-h-screen bg-black text-white">
    <div id="root"></div>
    <script type="text/babel">
      const { useEffect, useMemo, useRef, useState } = React;

      function App(){
        const BDAY = useMemo(() => new Date("2025-08-28T00:00:00"), []); // America/Chicago
        const [now, setNow] = useState(new Date());
        useEffect(() => { const id = setInterval(() => setNow(new Date()), 1000); return () => clearInterval(id); }, []);
        const diff = Math.max(0, BDAY.getTime() - now.getTime());
        const d = Math.floor(diff / (1000*60*60*24));
        const h = Math.floor((diff / (1000*60*60)) % 24);
        const m = Math.floor((diff / (1000*60)) % 60);
        const s = Math.floor((diff / 1000) % 60);

        const containerRef = useRef(null);
        function burstHearts(){
          const c = containerRef.current; if(!c) return;
          for(let i=0;i<16;i++){ const h=document.createElement('div'); h.className='heart-particle'; h.style.left=Math.random()*100+'%';
            h.style.setProperty('--tx',(Math.random()*100-50).toFixed(0)+'px'); h.style.setProperty('--ty',(-(Math.random()*140+60)).toFixed(0)+'px');
            c.appendChild(h); setTimeout(()=>h.remove(), 2200); }
        }

        return (
          <div ref={containerRef} className="min-h-screen bg-black text-white relative overflow-hidden">
            <NeonBackdrop />

            <div className="relative z-10 max-w-5xl mx-auto px-6 pt-10 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <span className="w-3 h-3 rounded-full bg-cyan-400 animate-pulse" />
                <span className="uppercase tracking-[0.35em] text-xs text-cyan-300/80">NETRUNNER LINK</span>
              </div>
              <div className="text-xs text-pink-300/80">v2.6.0 ‚Äî Birthday Build</div>
            </div>

            <header className="relative z-10 max-w-5xl mx-auto px-6 pb-8 pt-6">
              <h1 className="text-4xl sm:text-6xl font-black leading-tight">Dalton // 24 ‚Äî Night City Uplink</h1>
              <p className="mt-3 text-cyan-200/90 max-w-2xl">
                Happy Birthday, <span className="font-semibold text-white">Dalton!</span> I know this is not much but I hope you like it ‚ô°
              </p>
              <div className="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3">
                <TimerCard label="Days" value={d} />
                <TimerCard label="Hours" value={h} />
                <TimerCard label="Minutes" value={m} />
                <TimerCard label="Seconds" value={s} />
              </div>
            </header>

            <main className="relative z-10 max-w-5xl mx-auto px-6 pb-20 grid lg:grid-cols-2 gap-6">
              <Panel title="Song Player" subtitle="Auto‚Äëplays when set (muted on mobile)">
                <SongEmbed />
              </Panel>

              <Panel title="Birthday Cake" subtitle="24 candles ‚Äî tap to blow them out">
                <BirthdayCake />
              </Panel>

              <div className="lg:col-span-2">
                <Panel title="Memory Shards" subtitle="Save little moments here">
                  <MemoryBoard burstHearts={burstHearts} />
                </Panel>
              </div>
            </main>

            <footer className="relative z-10 max-w-5xl mx-auto px-6 pb-24 text-center">
              <button onClick={burstHearts} className="px-5 py-3 rounded-2xl border border-white/20 bg-white/5 hover:bg-white/10">
                Deploy confetti hearts üíú
              </button>
              <p className="text-xs text-white/50 mt-4">Built by Rachel&lt;ùüë</p>
            </footer>
          </div>
        );
      }

      function Panel({ title, subtitle, children }){
        return (
          <section className="rounded-2xl border border-white/15 bg-white/5 backdrop-blur p-5">
            <div className="mb-4">
              <h2 className="text-xl font-bold tracking-wide text-white/90">{title}</h2>
              {subtitle && <p className="text-xs text-white/60">{subtitle}</p>}
            </div>
            {children}
          </section>
        );
      }

      function TimerCard({ label, value }){
        return (
          <div className="rounded-2xl p-4 border border-cyan-400/30 bg-cyan-500/10 text-center">
            <div className="text-3xl font-extrabold tabular-nums">{String(value).padStart(2, "0")}</div>
            <div className="text-[10px] uppercase tracking-widest text-cyan-200/80">{label}</div>
          </div>
        );
      }

      function NeonBackdrop(){
        return (
          <div aria-hidden className="absolute inset-0">
            <div className="absolute -inset-40"
              style={{backgroundImage:
                "radial-gradient(circle at 30% 20%, rgba(0,255,255,.25), transparent 40%)," +
                "radial-gradient(circle at 70% 30%, rgba(255,0,128,.18), transparent 40%)," +
                "radial-gradient(circle at 50% 80%, rgba(255,255,0,.12), transparent 50%)"}}/>
            <div className="absolute inset-0 opacity-20"
              style={{backgroundImage:
                "linear-gradient(rgba(255,255,255,.08) 1px, transparent 1px), " +
                "linear-gradient(90deg, rgba(255,255,255,.08) 1px, transparent 1px)",
                backgroundSize:"48px 48px"}}/>
            <div className="absolute inset-0 mix-blend-overlay"
              style={{backgroundImage:"repeating-linear-gradient(0deg, rgba(255,255,255,.05), rgba(255,255,255,.05) 1px, transparent 1px, transparent 3px)"}}/>
          </div>
        );
      }

      function getYouTubeIdFromUrl(url){
        try{
          if(!url) return "";
          const u = new URL(url, window.location.href);
          if(u.hostname.includes("youtu.be")) return u.pathname.slice(1);
          if(u.searchParams.get("v")) return u.searchParams.get("v");
          if(/^[a-zA-Z0-9_-]{11}$/.test(url)) return url;
          return "";
        }catch{
          return /^[a-zA-Z0-9_-]{11}$/.test(url) ? url : "";
        }
      }
      function SongEmbed(){
        const DEFAULT_ID = 'sZj0_WHcc8o'; // baked-in link
        const sp = new URLSearchParams(window.location.search);
        // Optional override via ?yt=VIDEO_ID or full URL
        const override = sp.get("yt");
        let id = getYouTubeIdFromUrl(override) || DEFAULT_ID;
        // Persist current choice so reloads keep it (unless a new ?yt= is provided)
        try { localStorage.setItem("dalton-yt", id); } catch(e) {}
        const src = `https://www.youtube.com/embed/${id}?autoplay=1&mute=1&playsinline=1&rel=0&start=1`;
        return (
          <div className="aspect-video rounded-2xl overflow-hidden border border-pink-500/30">
            <iframe
              className="w-full h-full"
              src={src}
              title="YouTube player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowFullScreen
            />
          </div>
        );
      }

      function BirthdayCake(){
        const count = 24;
        const [blown, setBlown] = React.useState(Array.from({length: count}, () => false));
        const blownOut = blown.filter(Boolean).length;
        function toggle(i){ setBlown(b => { const c=b.slice(); c[i]=!c[i]; return c; }); }
        React.useEffect(() => {
          if(blownOut === count){
            const t = document.createElement('div');
            t.textContent = "Make a wish üéÇ";
            Object.assign(t.style, {position:'fixed', top:'16px', left:'50%', transform:'translateX(-50%)',
              background:'rgba(0,0,0,.6)', color:'#fff', padding:'8px 12px', borderRadius:'12px', zIndex: 9999});
            document.body.appendChild(t); setTimeout(() => t.remove(), 2000);
          }
        }, [blownOut]);
        const rows = [8,8,8]; let idx = 0;
        return (
          <div className="rounded-2xl p-6 bg-white/5 border border-white/10">
            <div className="mx-auto w-full max-w-xl">
              <div className="h-28 bg-gradient-to-b from-fuchsia-500/40 to-cyan-500/30 rounded-t-2xl border-x border-t border-white/20 relative overflow-hidden">
                <div className="absolute inset-0 flex flex-col justify-center gap-3 px-6">
                  {rows.map((n, r) => (
                    <div key={r} className="flex justify-center gap-3">
                      {Array.from({length:n}).map((_, j) => {
                        const i = idx++; const isOn = !blown[i];
                        return (
                          <div key={j} className="flex flex-col items-center select-none" onClick={() => toggle(i)}>
                            <div className={"w-1 h-4 bg-white rounded-t-sm " + (isOn ? "shadow-[0_0_8px_rgba(255,255,255,.6)]" : "opacity-60")} />
                            <div className={"-mt-1 w-2 h-2 rounded-full " + (isOn ? "bg-amber-300 animate-[flicker_1s_ease_infinite]" : "bg-transparent")} />
                          </div>
                        );
                      })}
                    </div>
                  ))}
                </div>
              </div>
              <div className="h-10 bg-[rgba(255,255,255,0.08)] rounded-b-2xl border-x border-b border-white/20" />
            </div>
            <div className="text-center text-xs text-white/70 mt-3">Tap candles to blow them out ‚Äî {count - blownOut} left</div>
          </div>
        );
      }

      function MemoryBoard({ burstHearts }){
        const [noteText, setNoteText] = React.useState("");
        const [notes, setNotes] = React.useState(() => {
          const saved = localStorage.getItem("dalton-notes");
          return saved ? JSON.parse(saved) : [];
        });
        React.useEffect(() => { localStorage.setItem("dalton-notes", JSON.stringify(notes)); }, [notes]);
        return (
          <div className="space-y-3">
            <div className="flex gap-2">
              <input
                value={noteText}
                onChange={(e) => setNoteText(e.target.value)}
                placeholder="Type a memory, joke, or msg..."
                className="flex-1 bg-black/60 border border-fuchsia-500/40 rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-fuchsia-400"
              />
              <button
                onClick={() => {
                  if (!noteText.trim()) return;
                  setNotes((n) => [{ id: Date.now(), text: noteText.trim(), when: new Date().toLocaleString() }, ...n]);
                  setNoteText("");
                  burstHearts();
                }}
                className="px-4 py-2 rounded-xl bg-fuchsia-500/20 border border-fuchsia-400 hover:bg-fuchsia-500/30"
              >Add</button>
            </div>
            <ul className="space-y-2 max-h-60 overflow-auto pr-2">
              {notes.map((n) => (
                <li key={n.id} className="group p-3 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition">
                  <div className="text-sm text-white/90">{n.text}</div>
                  <div className="text-[10px] text-white/50 mt-1">{n.when}</div>
                  <button onClick={() => setNotes((list) => list.filter((x) => x.id !== n.id))} className="opacity-0 group-hover:opacity-100 text-[10px] text-red-300 mt-1">delete</button>
                </li>
              ))}
            </ul>
          </div>
        );
      }

      // Install tip for Discord/iOS
      function isIOS(){ return /iPhone|iPad|iPod/i.test(navigator.userAgent); }
      function isDiscord(){ return /Discord/i.test(navigator.userAgent); }
      function isInApp(){ return isDiscord() || /FBAN|FBAV|Instagram|Line\//i.test(navigator.userAgent); }
      function InstallTip(){
        const [show, setShow] = React.useState(false);
        React.useEffect(() => { if(isIOS() && isInApp()) setShow(true); }, []);
        if(!show) return null;
        return (
          <div className="fixed bottom-3 left-1/2 -translate-x-1/2 z-50 max-w-[90%] rounded-2xl border border-white/20 bg-black/80 backdrop-blur px-4 py-3 text-sm">
            <div className="text-white/90">For installing on iPhone, please open in <b>Safari</b> first.</div>
            <div className="text-white/60 text-xs mt-1">In Discord: tap ‚Ä¢‚Ä¢‚Ä¢ ‚Üí <b>Open in Safari</b> ‚Üí Share ‚Üí <b>Add to Home Screen</b>.</div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<><App /><InstallTip /></>);
    </script>
    <script>
      if ('serviceWorker' in navigator) { window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js')); }
    </script>

    <style>
      .heart-particle { position: absolute; bottom: 80px; width: 12px; height: 12px; transform: translate(-50%, 0) rotate(45deg);
        background: linear-gradient(135deg, #ff7ad9, #00f0ff); animation: float 2.2s ease-out forwards;
        box-shadow: 0 0 10px rgba(255,122,217,.6), 0 0 16px rgba(0,240,255,.4); }
      .heart-particle:before, .heart-particle:after { content: ""; position: absolute; width: 12px; height: 12px; background: inherit; border-radius: 50%; }
      .heart-particle:before { left: -6px; } .heart-particle:after { top: -6px; }
      @keyframes float { 0% { opacity:1; transform: translate(var(--x, -50%), 0) rotate(45deg);} 100% { opacity:0; transform: translate(calc(var(--x, -50%) + var(--tx)), var(--ty)) rotate(45deg);} }
    </style>
  </body>
</html>
